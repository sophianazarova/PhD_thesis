size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
str(yong.old.sqmeter)
(sum.young.old<-t(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
(young.old.percents<-t(t(sum.young.old)/colSums(sum.young.old, na.rm=T))*100)
#динамика молоди и половозрелых в %
(sum.young.old<-t(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
(young.old.percents<-t(t(sum.young.old)/colSums(sum.young.old, na.rm=T))*100)
write.table(t(young.old.percents), file="estuary_young_old_percent.csv", sep=";", dec=",")
#корреляция - молодь и половозрелые в %
(spearman.young.old.sum.percent<-cor.test(young.old.percents[1,2:21], young.old.percents[3,1:20], method="spearman"))
plot(x=young.old.percents[3,1:20], y=young.old.percents[1,2:21])
str(young.old.percents)
(spearman.young.old.sum.percent<-cor.test(young.old.percents[1,2:6], young.old.percents[3,1:5], method="spearman"))
plot(x=young.old.percents[3,1:5], y=young.old.percents[1,2:6])
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Ryashkov_YuG//")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Ryashkov_YuG//")
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#year<-factor(year)
(young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T))))
(young.old.table<-table(young.old.int,year,sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
#динамика молоди и половозрелых в %
(sum.young.old<-t(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
(young.old.percents<-t(t(sum.young.old)/colSums(sum.young.old, na.rm=T))*100)
write.table(t(young.old.percents), file="estuary_young_old_percent.csv", sep=";", dec=",")
str(young.old.percents)
(spearman.young.old.sum.percent<-cor.test(young.old.percents[1,2:12], young.old.percents[3,1:11], method="spearman"))
plot(x=young.old.percents[3,1:11], y=young.old.percents[1,2:12])
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Ryashkov_ZRS/")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Ryashkov_ZRS/")
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#динамика молоди <2mm и половозрелых  >8mm
(young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T))))
(young.old.table<-table(young.old.int,year,sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
#динамика молоди и половозрелых в %
(sum.young.old<-t(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
(young.old.percents<-t(t(sum.young.old)/colSums(sum.young.old, na.rm=T))*100)
write.table(t(young.old.percents), file="estuary_young_old_percent.csv", sep=";", dec=",")
write.table(t(young.old.percents), file="zrs_young_old_percent.csv", sep=";", dec=",")
str(young.old.percents)
(spearman.young.old.sum.percent<-cor.test(young.old.percents[1,2:19], young.old.percents[3,1:18], method="spearman"))
plot(x=young.old.percents[3,1:18], y=young.old.percents[1,2:19])
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Luvenga_Goreliy/")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Luvenga_Goreliy//")
# размерная структура средние по годам по горизонтам
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#year<-factor(year)
young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T)))
(young.old.table<-table(young.old.int, year, tidal_level, sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
str(young.old.sqmeter)
(sum.young.old<-t(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$tidal_level[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
(sum.young.old<-(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$tidal_level[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
young.old.sqmeter$young.old.int
young.old.sqmeter
sum.young.old
str(sum.young.old)
(young.old.percents<-(sum.young.old)/apply(sum.young.old,MARGIN=2,FUN=sum na.rm=T))*100)
(young.old.percents<-(sum.young.old)/apply(sum.young.old,MARGIN=2,FUN=sum, na.rm=T))*100)
(young.old.percents<-(sum.young.old)/apply(sum.young.old,MARGIN=2,FUN=sum, na.rm=T)*100)
write.table(t(young.old.percents), file="estuary_young_old_percent.csv", sep=";", dec=",")
str(apply(sum.young.old,MARGIN=2,FUN=sum, na.rm=T))
(young.old.percents<-(sum.young.old)/apply(sum.young.old,MARGIN=c(1,3),FUN=sum, na.rm=T)*100)
(young.old.percents<-(sum.young.old)/apply(sum.young.old,MARGIN=1,3,FUN=sum, na.rm=T)*100)
str(apply(sum.young.old,MARGIN=1,3,FUN=sum, na.rm=T))
str(apply(sum.young.old,MARGIN=c(1,3),FUN=sum, na.rm=T))
(young.old.percents<-(sum.young.old)/apply(sum.young.old,MARGIN=c(1,3),FUN=sum, na.rm=T)*100)
str(sum.young.old)
str(apply(sum.young.old,MARGIN=c(1,3),FUN=sum, na.rm=T))
(sum.young.old<-(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$tidal_level[young.old.sqmeter$young.old.int!="(0,1]"],),
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"],
FUN=sum, na.rm=T)))
(sum.young.old<-(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$tidal_level[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
(young.old.percents<-(sum.young.old)/apply(sum.young.old,MARGIN=c(1,2),FUN=sum, na.rm=T)*100)
dim(sum.young.old)
array(dim=dim(sum.young.old), dimnames=dimnames(sum.young.old), data=rep(x=apply(sum.young.old, MARGIN=c(1,2), FUN=sum, na.rm=T), 3)
)
summ.all.3times<-array(dim=dim(sum.young.old), dimnames=dimnames(sum.young.old), data=rep(x=apply(sum.young.old, MARGIN=c(1,2), FUN=sum, na.rm=T), 3))
(young.old.percents<-(sum.young.old)/summ.all.3times*100)
write.table(t(young.old.percents), file="estuary_young_old_percent.csv", sep=";", dec=",")
write.table((young.old.percents), file="estuary_young_old_percent.csv", sep=";", dec=",")
write.table((young.old.percents), file="goreliy_young_old_percent.csv", sep=";", dec=",")
str(young.old.percents)
(spearman.young.old.sum.percent<-cor.test(young.old.percents[2:21,,1], young.old.percents[1:20,,3], method="spearman"))
plot(y=young.old.percents[2:21,,1], x=young.old.percents[1:20,,3])
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Luvenga_II_razrez/")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Luvenga_II_razrez/")
# размерная структура средние по годам по горизонтам
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#year<-factor(year)
str(ishodnik)
young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T)))
(young.old.table<-table(young.old.int, year, tidal_level, sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
str(young.old.sqmeter)
(sum.young.old<-(tapply(young.old.sqmeter$Freq[young.old.sqmeter$young.old.int!="(0,1]"],
INDEX=list(young.old.sqmeter$year[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$tidal_level[young.old.sqmeter$young.old.int!="(0,1]"],
young.old.sqmeter$young.old.int[young.old.sqmeter$young.old.int!="(0,1]"]),
FUN=sum, na.rm=T)))
summ.all.3times<-array(dim=dim(sum.young.old), dimnames=dimnames(sum.young.old),
data=rep(x=apply(sum.young.old, MARGIN=c(1,2), FUN=sum, na.rm=T), 3))
(young.old.percents<-(sum.young.old)/summ.all.3times*100)
write.table((young.old.percents), file="2razrez_young_old_percent.csv", sep=";", dec=",")
str(young.old.percents)
(spearman.young.old.sum.percent<-cor.test(young.old.percents[2:9,,1], young.old.percents[1:8,,3], method="spearman"))
plot(y=young.old.percents[2:9,,1], x=young.old.percents[1:8,,3])
setwd("~/Dropbox/PhD_thesis/PhD_thesis/young_old_all_Kandalaksha/")
ishodnik<-write.table("young_old_all_Kandalaksha.csv", header=T, sep=";", dec=",")
str(ishodnik)
setwd("~/Dropbox/PhD_thesis/PhD_thesis/young_old_all_Kandalaksha/")
ishodnik<-write.table("young_old_all_Kandalaksha.csv", header=T, sep=";", dec=",")
str(ishodnik)
all.young.old<-write.table(file="young_old_all_Kandalaksha.csv", header=T, sep=";", dec=",")
ishodnik<-write.table(file="young_old_all_Kandalaksha.csv", head=T, sep=";", dec=",")
ishodnik<-read.table(file="young_old_all_Kandalaksha.csv", head=T, sep=";", dec=",")
str(ishodnik)
ishodnik<-read.table(file="young_old_all_Kandalaksha.csv", head=T, sep=";", dec=",")
str(ishodnik)
hist(ishodnik$young)
hist(ishodnik$old)
(spearman.young.old.all.percent<-cor.test(ishodnik$young, ishodnik$old, method="spearman"))
plot(y=ishodnik$young, x=ishodnik$old)
str(ishodnik)
dev.off()
embedFonts("young_old.pdf") #встройка шрифтов в файл
plot(y=ishodnik$young, x=ishodnik$old)
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей в поселении на обилие молоди через год")
pdf(file="young_old_all.pdf", family="NimbusSan") # указываем шрифт подпией
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей в поселении на обилие молоди через год")
dev.off()
embedFonts("young_old_all.pdf") #встройка шрифтов в файл
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей \\ в поселении на обилие молоди через год")
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей
в поселении на обилие молоди через год")
pdf(file="young_old_all.pdf", family="NimbusSan") # указываем шрифт подпией
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей
в поселении на обилие молоди через год")
dev.off()
embedFonts("young_old_all.pdf") #встройка шрифтов в файл
str(ishodnik)
levels(ishodnik$area)
as.numeric(levels(ishodnik$area))
labels(ishodnik$area)
levels(ishodnik$area)
as.numeric(ishodnik$area)
c(as.numeric(ishodnik$area)+as.numeric(ishodnik$tidal_zone))
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей
в поселении на обилие молоди через год",
col=c(as.numeric(ishodnik$area)+as.numeric(ishodnik$tidal_zone)))
c(as.numeric(ishodnik$area)*10+as.numeric(ishodnik$tidal_zone))
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей
в поселении на обилие молоди через год",
col=c(as.numeric(ishodnik$area)*10+as.numeric(ishodnik$tidal_zone)))
pdf(file="young_old_all1.pdf", family="NimbusSan") # указываем шрифт подпией
plot(y=ishodnik$young, x=ishodnik$old,
xlab="доля половозрелых моллюсков, %",
ylab="доля годовалых моллюсков, %",
main="Влияние доли половозрелых особей
в поселении на обилие молоди через год",
col=c(as.numeric(ishodnik$area)*10+as.numeric(ishodnik$tidal_zone)))
dev.off()
embedFonts("young_old_all1.pdf") #встройка шрифтов в файл
write.table("spearman_young_olg_all.csv", spearman.young.old.all.percent, sep=";", dec=",")
write.table("spearman_young_olg_all.csv", spearman.young.old.all.percent)
write.table(file="spearman_young_olg_all.csv", spearman.young.old.all.percent)
spearman.young.old.all.percent
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Estuatiy_Luvenga")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Estuatiy_Luvenga")
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
biomass.measure<-read.table(file="biomass.csv", sep=";", dec=",", head=T)
attach(ishodnik)
(young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T))))
(young.old.table<-table(young.old.int,year,sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
str(young.old.sqmeter)
(mean.young.old.sqmeter<-t(tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=mean, na.rm=T)))
(sd.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=sd, na.rm=T))
n.samples<-tapply(samples.names$sample,samples.names$year, length )
(sem.young.old.sqmeter <-t(sd.young.old.sqmeter/sqrt(as.vector(n.samples))))
write.table(t(mean.young.old.sqmeter), file="estuary_young_old_mean.csv", sep=";", dec=",")
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Lomnishniy/")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Lomnishniy/")
# размерная структура суммарно по годам по горизонтам
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#динамика молоди <2mm и половозрелых  >8mm
(young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T))))
(young.old.table<-table(young.old.int,year,sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
(mean.young.old.sqmeter<-t(tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=mean, na.rm=T)))
(sd.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=sd, na.rm=T))
n.samples<-tapply(samples.names$sample,samples.names$year, length )
(sem.young.old.sqmeter <-t(sd.young.old.sqmeter/sqrt(as.vector(n.samples))))
write.table(t(mean.young.old.sqmeter), file="lomnishniy_young_old_mean.csv", sep=";", dec=",")
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Luvenga_Goreliy/")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Luvenga_Goreliy//")
# размерная структура средние по годам по горизонтам
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#динамика молоди <2mm и половозрелых  >8mm
young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T)))
(young.old.table<-table(young.old.int, year, tidal_level, sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
str(young.old.sqmeter)
(mean.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,
INDEX=list(young.old.sqmeter$year,young.old.sqmeter$young.old.int, young.old.sqmeter$tidal_level),
FUN=mean, na.rm=T))
for (i in 1:4)
{assign(paste("mean",dimnames(mean.young.old.sqmeter)[[3]][i],sep="."),mean.young.old.sqmeter[,,i])
}
(sd.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,
INDEX=list(young.old.sqmeter$year, young.old.sqmeter$tidal_level, young.old.sqmeter$young.old.int),
FUN=sd, na.rm=T))
(n.samples<-tapply(samples.names$sample,list(samples.names$year,samples.names$tidal_level), length ))
(n.samples.df<-as.data.frame(n.samples))
(sem.young.old.sqmeter <-sd.young.old.sqmeter/sqrt(as.vector(n.samples)))
sem.young.old.sqmeter[sem.young.old.sqmeter==sd.young.old.sqmeter]<-NA
for (i in 1:4)
{assign(paste("sem",dimnames(sem.young.old.sqmeter)[[2]][i],sep="."),sem.young.old.sqmeter[,i,])
}
str(mean.young.old.sqmeter)
write.table(t(mean.young.old.sqmeter), file="goreliy_young_old_mean.csv", sep=";", dec=",")
write.table(mean.young.old.sqmeter, file="goreliy_young_old_mean.csv", sep=";", dec=",")
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Luvenga_II_razrez/")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Luvenga_II_razrez/")
# размерная структура средние по годам по горизонтам
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#year<-factor(year)
str(ishodnik)
#динамика молоди <2mm и половозрелых  >8mm
young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T)))
(young.old.table<-table(young.old.int, year, tidal_level, sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
str(young.old.sqmeter)
(mean.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,
INDEX=list(young.old.sqmeter$year,young.old.sqmeter$young.old.int, young.old.sqmeter$tidal_level),
FUN=mean, na.rm=T))
for (i in 1:4)
{assign(paste("mean",dimnames(mean.young.old.sqmeter)[[3]][i],sep="."),mean.young.old.sqmeter[,,i])
}
(sd.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,
INDEX=list(young.old.sqmeter$year, young.old.sqmeter$tidal_level, young.old.sqmeter$young.old.int),
FUN=sd, na.rm=T))
(n.samples<-tapply(samples.names$sample,list(samples.names$year,samples.names$tidal.level), length ))
(n.samples.df<-as.data.frame(n.samples))
(sem.young.old.sqmeter <-sd.young.old.sqmeter/sqrt(as.vector(n.samples)))
sem.young.old.sqmeter[sem.young.old.sqmeter==sd.young.old.sqmeter]<-NA
for (i in 1:4)
{assign(paste("sem",dimnames(sem.young.old.sqmeter)[[2]][i],sep="."),sem.young.old.sqmeter[,i,])
}
write.table(mean.young.old.sqmeter, file="2razrez_young_old_mean.csv", sep=";", dec=",")
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Ryashkov_YuG//")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Ryashkov_YuG//")
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#динамика молоди <2mm и половозрелых  >8mm
(young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T))))
(young.old.table<-table(young.old.int,year,sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
(mean.young.old.sqmeter<-t(tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=mean, na.rm=T)))
(sd.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=sd, na.rm=T))
n.samples<-tapply(samples.names$sample,samples.names$year, length )
(sem.young.old.sqmeter <-t(sd.young.old.sqmeter/sqrt(as.vector(n.samples))))
write.table(t(mean.young.old.sqmeter), file="YuG_young_old_mean.csv", sep=";", dec=",")
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Ryashkov_ZRS/")
#setwd("~/note_backup_2013-04-13/PhD_thesis/White_Sea/Ryashkov_ZRS/")
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
#динамика молоди <2mm и половозрелых  >8mm
(young.old.int<-cut(Length.mm, breaks=c(1,2.5,7.9,max(Length.mm, na.rm=T))))
(young.old.table<-table(young.old.int,year,sample))
young.old.df<-as.data.frame(young.old.table) # как таблица данных
#убираем те пробы которых на самом деле нету
for (i in 1:length(levels(young.old.df$year)))
{ (xxx<-young.old.df$sample[young.old.df$year==levels(young.old.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(young.old.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[young.old.df$year==levels(young.old.df$year)[i]][antixxx]<-NA
}
#теперь на квадратный метр
young.old.sqmeter<-young.old.df
for (i in 1:length(levels(young.old.sqmeter$year)))
{
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]]<-
young.old.sqmeter$Freq[young.old.sqmeter$year==levels(young.old.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(young.old.sqmeter$year)[i]]
}
str(yong.old.sqmeter)
(mean.young.old.sqmeter<-t(tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=mean, na.rm=T)))
(sd.young.old.sqmeter<-tapply(young.old.sqmeter$Freq,INDEX=list(young.old.sqmeter$year, young.old.sqmeter$young.old.int),FUN=sd, na.rm=T))
n.samples<-tapply(samples.names$sample,samples.names$year, length )
(sem.young.old.sqmeter <-t(sd.young.old.sqmeter/sqrt(as.vector(n.samples))))
write.table(t(mean.young.old.sqmeter), file="ZRS_young_old_mean.csv", sep=";", dec=",")
setwd("~/Dropbox/PhD_thesis/PhD_thesis/young_old_all_Kandalaksha/")
