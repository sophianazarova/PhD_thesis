library("lattice")
install.packages("rgl")
install.packages("rgl")
install.packages("rgl")
library(rgl)
Pala.08<-read.table("Pala_autumn_2008.csv", header=T, sep=";", dec=",")
setwd("~/Dropbox/PhD_thesis/PhD_thesis/Barenc_Sea/distribution_Moran")
Pala.08<-read.table("Pala_autumn_2008.csv", header=T, sep=";", dec=",")
str(Pala.08)
plot3d(x=Pala.08$X, y=Pala.08$y, z=Pala.08$N_Macoma_balthica,type=h)
plot3d(x=Pala.08$X, y=Pala.08$y, z=Pala.08$N_Macoma_balthica, type="s", size=0.75, lit=FALSE)
plot3d(x=Pala.08$X, y=Pala.08$y, z=Pala.08$N_Macoma_balthica, type="s", size=0.75, lit=FALSE)
example(plot3d)
plot3d(x=Pala.08$X, y=Pala.08$y, z=Pala.08$N_Macoma_balthica)
str(Pala.08)
x<-rnorm(100)
y<-rnorm(100)
z<-rnorm(100)
plot3d(x,y,z)
setwd("~/Dropbox/PhD_thesis/PhD_thesis/White_Sea/Luvenga_Goreliy/")
ishodnik<-read.table(file="length.csv", sep=";", dec=",", head=T)
samples.squares<-read.table(file="squares.csv", sep=";", dec=",", head=T)
samples.names<-read.table(file="sample.csv", sep=";", dec=",", head=T)
attach(ishodnik)
(N.sqmeter<-tapply(size.str.sqmeter$Freq, list(size.str.sqmeter$year, size.str.sqmeter$sample, size.str.df$tidal_level), sum))
(N.mean.sqmeter<-apply(N.sqmeter, na.rm=T, MARGIN=c(1,3), FUN=mean))
N.mean.sqmeter[11,3]<-NA
(N.sd.sqmeter<-apply(N.sqmeter, na.rm=T, MARGIN=c(1,3), FUN=sd))
(N.sem.sqmeter<-N.sd.sqmeter/sqrt(n.samples))
N.sem.sqmeter[N.sem.sqmeter==N.sd.sqmeter]<-NA
(N.sqmeter<-tapply(size.str.sqmeter$Freq, list(size.str.sqmeter$year, size.str.sqmeter$sample, size.str.df$tidal_level), sum))
Length.int<-cut(Length.mm, breaks=seq(0,20,1))
(size.str.table<-table(Length.int,year, tidal_level, sample))
size.str.df<-as.data.frame(size.str.table) # как таблица данных
for (i in 1:length(levels(size.str.df$year)))
{ (xxx<-size.str.df$sample[size.str.df$year==levels(size.str.df$year)[i] ]%in%
samples.names$sample[samples.names$year==levels(size.str.df$year)[i]])
antixxx<-as.logical(1-xxx)
size.str.df$Freq[size.str.df$year==levels(size.str.df$year)[i]][antixxx]<-NA
}
subset(size.str.df, size.str.df$year=="1995" & size.str.df$sample=="mg4")
size.str.sqmeter<-size.str.df
for (i in 1:length(levels(size.str.sqmeter$year)))
{
size.str.sqmeter$Freq[size.str.sqmeter$year==levels(size.str.sqmeter$year)[i]]<-
size.str.sqmeter$Freq[size.str.sqmeter$year==levels(size.str.sqmeter$year)[i]] *
samples.squares$square[samples.squares$year==levels(size.str.sqmeter$year)[i]]
}
for (i in 1: length(levels(size.str.sqmeter$tidal_level)))
{
write.table(assign(paste(levels(size.str.sqmeter$tidal_level)[i]),
subset(size.str.sqmeter, size.str.sqmeter$tidal_level==levels(size.str.sqmeter$tidal_level)[i])), file=paste(levels(size.str.sqmeter$tidal_level)[i]), sep=",")
}
(n.samples<-tapply(samples.names$sample,list(samples.names$year,samples.names$tidal_level), length ))
(n.samples.df<-as.data.frame(n.samples))
#верхний горизонт
(mean.sqmeter.high<-t(tapply(high$Freq,INDEX=list(high$year,  high$Length.int),FUN=mean, na.rm=T)))
mean.sqmeter.high.df<-as.data.frame(mean.sqmeter.high)
(sd.sqmeter.high<-tapply(high$Freq,INDEX=list(high$year,  high$Length.int),FUN=sd, na.rm=T))
(sem.sqmeter.high <-t(sd.sqmeter.high/sqrt(n.samples.df$high)))
#TODO надо те строки где по одной пробе сделать вместо ошибки NA!!
sem.sqmeter.high.df<-as.data.frame(sem.sqmeter.high)
sem.sqmeter.high[sem.sqmeter.high==t(sd.sqmeter.high)]<-0
#средний горизонт
mean.sqmeter.middle<-t(tapply(middle$Freq,INDEX=list(middle$year,  middle$Length.int),FUN=mean, na.rm=T))
mean.sqmeter.middle.df<-as.data.frame(mean.sqmeter.middle)
sd.sqmeter.middle<-tapply(middle$Freq,INDEX=list(middle$year,  middle$Length.int),FUN=sd, na.rm=T)
sem.sqmeter.middle <-t(sd.sqmeter.middle/sqrt(n.samples.df$middle))
sem.sqmeter.middle.df<-as.data.frame(sem.sqmeter.middle)
sem.sqmeter.middle[sem.sqmeter.middle==t(sd.sqmeter.middle)]<-0
#граница среднего и нижнего горизонта, в фукусах
mean.sqmeter.midlow<-t(tapply(midlow$Freq,INDEX=list(midlow$year,  midlow$Length.int),FUN=mean, na.rm=T))
mean.sqmeter.midlow.df<-as.data.frame(mean.sqmeter.midlow)
sd.sqmeter.midlow<-tapply(midlow$Freq,INDEX=list(midlow$year,  midlow$Length.int),FUN=sd, na.rm=T)
sem.sqmeter.midlow <-t(sd.sqmeter.midlow/sqrt(n.samples.df$midlow))
sem.sqmeter.midlow.df<-as.data.frame(sem.sqmeter.midlow)
sem.sqmeter.midlow[sem.sqmeter.midlow==t(sd.sqmeter.midlow)]<-0
#нижний горизонт, у нуля глубин
(mean.sqmeter.low<-t(tapply(low$Freq,INDEX=list(low$year,  low$Length.int),FUN=mean, na.rm=T)))
mean.sqmeter.low.df<-as.data.frame(mean.sqmeter.low)
sd.sqmeter.low<-tapply(low$Freq,INDEX=list(low$year,  low$Length.int),FUN=sd, na.rm=T)
sem.sqmeter.low <-t(sd.sqmeter.low/sqrt(n.samples.df$low))
sem.sqmeter.low.df<-as.data.frame(sem.sqmeter.low)
sem.sqmeter.low[sem.sqmeter.low==t(sd.sqmeter.low)]<-0
length.class<-seq(1,20,1)
(N.sqmeter<-tapply(size.str.sqmeter$Freq, list(size.str.sqmeter$year, size.str.sqmeter$sample, size.str.df$tidal_level), sum))
(N.mean.sqmeter<-apply(N.sqmeter, na.rm=T, MARGIN=c(1,3), FUN=mean))
N.mean.sqmeter[11,3]<-NA
(N.sd.sqmeter<-apply(N.sqmeter, na.rm=T, MARGIN=c(1,3), FUN=sd))
(N.sem.sqmeter<-N.sd.sqmeter/sqrt(n.samples))
N.sem.sqmeter[N.sem.sqmeter==N.sd.sqmeter]<-NA
(N2.sqmeter<-tapply(size.str.sqmeter$Freq[size.str.sqmeter$Length.int!="(0,1]"],
list(size.str.sqmeter$year[size.str.sqmeter$Length.int!="(0,1]"],
size.str.sqmeter$sample[size.str.sqmeter$Length.int!="(0,1]"],
size.str.df$tidal_level[size.str.sqmeter$Length.int!="(0,1]"]), sum))
(N2.mean.sqmeter<-apply(N2.sqmeter, na.rm=T, MARGIN=c(1,3), FUN=mean))
N2.mean.sqmeter[11,3]<-NA
(N2.sd.sqmeter<-apply(N2.sqmeter, na.rm=T, MARGIN=c(1,3), FUN=sd))
(N2.sem.sqmeter<-N2.sd.sqmeter/sqrt(n.samples))
N2.sem.sqmeter[N2.sem.sqmeter==N2.sd.sqmeter]<-NA
(N2.sqmeter.high<-(N2.sqmeter)[,,1])
(N2.92.12.df.high<-data.frame(subset(samples.names, samples.names$tidal_level=="high"),
as.vector(t(N2.sqmeter.high))[!is.na(as.vector(t(N2.sqmeter.high)))])
(N2.sqmeter.high[!is.na(N2.sqmeter.high)])
kruskal.test(N2.92.98.df$as.vector.N2.92.98...is.na.as.vector.N2.92.98... ~ N2.92.98.df$year)
boxplot(N2.92.98.df$as.vector.N2.92.98...is.na.as.vector.N2.92.98... ~ N2.92.98.df$year)
(N2.sqmeter.high<-(N2.sqmeter)[,,1])
N2.sqmeter
N2.mean.sqmeter
str(N2.sqmeter)
str(as.data.frame(N2.sqmeter))
N2.sqmeter
head(N2.sqmeter)
summary(N2.sqmeter)
N2.sqmeter
N2.sqmeter[,,"low"]
N2.sqmeter[,2005:2012,"low"]
N2.sqmeter[2005:2012,,"low"]
N2.sqmeter[,14:20,"low"]
N2.sqmeter[14:20,,"low"]
N2.sqmeter[14:21,,"low"]
N2.sqmeter[13 & 15:17 & 20,,"low"]
N2.sqmeter[15:17,,"low"]
N2.sqmeter[15:17 & 20,,"low"]
N2.sqmeter[15:17,,"low"]
n.samples
n.samples[1,]
n.samples[1,2,]
n.samples[1 & 2,]
n.samples[1,] & n.samples[2,]
as.data.frame(N2.sqmeter[15:17,,"low"])
as.data.frame(t(N2.sqmeter[15:17,,"low"]))
samples.names
as.data.frame(t(N2.sqmeter[15:17,,]))
as.data.frame(t(N2.sqmeter[15:17,,"low"]))
as.data.frame(t(N2.sqmeter[15:17,,"low"])[!is.na(N2.sqmeter[15:17,,"low"])])
as.data.frame(t(N2.sqmeter[15:17,,"low"]))
N2.sqmeter["2005",,"low"]
N2.sqmeter["2005" & "2006",,"low"]
is.vector(N2.sqmeter["2005",,"low"])
subset(samples.names, subset=samples.names$year<=1998)
N2.multisample.low<-subset(samples.names, subset= samples.names$tidal_level=="low" & samples.names$year==2004 &
samples.names$year==2006:2008 & samples.names$year==2011)
N2.multisample.low<-subset(samples.names, subset=samples.names$tidal_level=="low" & samples.names$year==2004 &
samples.names$year==2006 &samples.names$year==2007 & samples.names$year==2008 &
samples.names$year==2011)
N2.multisample.low
N2.multisample.low<-subset(samples.names, subset=samples.names$tidal_level=="low")
N2.multisample.low
N2.multisample.low<-subset(subset(samples.names, subset=samples.names$tidal_level=="low"), subset=samples.names$year==2004 &
samples.names$year==2006 &samples.names$year==2007 & samples.names$year==2008 &
samples.names$year==2011)
N2.multisample.low
N2.multisample.low<-subset(subset(samples.names, subset=samples.names$tidal_level=="low" & samples.names$year==2004 |
samples.names$year==2006 | samples.names$year==2007 | samples.names$year==2008 |
samples.names$year==2011)
N2.multisample.low
N2.multisample.low<-subset(samples.names, subset=samples.names$tidal_level=="low" & samples.names$year==2004 |
samples.names$year==2006 | samples.names$year==2007 | samples.names$year==2008 |
samples.names$year==2011)
N2.multisample.low
N2.multisample.low<-subset(samples.names, subset=samples.names$tidal_level="low" & samples.names$year==2004 |
samples.names$year==2006 | samples.names$year==2007 | samples.names$year==2008 |
samples.names$year==2011)
samples.names$tidal_level=="low"
N2.multisample.low<-subset(samples.names, subset=samples.names$tidal_level=="low" & samples.names$year==2004 |
samples.names$year==2006 | samples.names$year==2007 | samples.names$year==2008 |
samples.names$year==2011)
samples.names$tidal_level=="low"
N2.multisample.low
subset(samples.names, subset=samples.names$tidal_level=="low")
N2.multisample.low<-subset(subset(samples.names, subset=samples.names$tidal_level=="low"), subset= samples.names$year==2004 |
samples.names$year==2006 | samples.names$year==2007 | samples.names$year==2008 |
samples.names$year==2011)
N2.multisample.low
subset(samples.names, subset=samples.names$tidal_level=="low")
N2.low<-subset(samples.names, subset=samples.names$tidal_level=="low")
N2.multisample.low<-subset(N2.low, subset= N2.low$year==2004 |
N2.low$year==2006 | N2.low$year==2007 | N2.low$year==2008 |
N2.low$year==2011)
N2.multisample.low
is.vector(N2.sqmeter[,,"low"])
N2.sqmeter[,,"low"]
as.vector(N2.sqmeter[,,"low"])
as.vector(N2.sqmeter[,,"low"])[is.na(as.vector(N2.sqmeter[,,"low"]))]
as.vector(N2.sqmeter[,,"low"])[!is.na(as.vector(N2.sqmeter[,,"low"]))]
N2.low<-data.frame(subset(samples.names, subset=samples.names$tidal_level=="low"),
as.vector(N2.sqmeter[,,"low"])[!is.na(as.vector(N2.sqmeter[,,"low"]))])
subset(samples.names, subset=samples.names$tidal_level=="low")
?data.frame
N2.low<-data.frame(subset(samples.names, subset=samples.names$tidal_level=="low"), as.vector(N2.sqmeter[,,"low"])[!is.na(as.vector(N2.sqmeter[,,"low"]))])
N2.low<-subset(samples.names, subset=samples.names$tidal_level=="low")
is.data.frame(N2.low)
length(N2.low)
length(N2.low$year)
N2.low$year
length(N2.low$sample)
N2.low
length(as.vector(N2.sqmeter[,,"low"])[!is.na(as.vector(N2.sqmeter[,,"low"]))])
as.vector(N2.sqmeter[,,"low"])
(N2.sqmeter
)
complete.cases(as.vector(N2.sqmeter[,,"low"]))
as.vector(N2.sqmeter[,,"low"])[complete.cases(as.vector(N2.sqmeter[,,"low"]))]
str(N2.sqmeter)
subset(samples.names, subset=samples.names$tidal_level=="low")
install.packages("reshape2")
library(reshape2)
?reshape2
length(subset(samples.names, subset=samples.names$tidal_level=="low")$year)
as.vector(N2.sqmeter[,,"low"])[!is.na(as.vector(N2.sqmeter[,,"low"]))]
length(samples.names$year)
as.vector(N2.sqmeter[,,"low"])[complete.cases(as.vector(N2.sqmeter[,,"low"]))][!=0]
as.vector(N2.sqmeter[,,"low"])[!is.na(as.vector(N2.sqmeter[,,"low"])) & !=0]
N2.low<-as.vector(N2.sqmeter[,,"low"])[!is.na(as.vector(N2.sqmeter[,,"low"]))]
N2.low[N2.low!=0]
install.packages("doBy"")
a
""
install.packages("doBy")
library(doBy)
library("doBy")
library(doBy)
install.packages("doBy")
install.packages("doBy")
